buildscript {
  repositories {
    jcenter()
  }
  dependencies {
    classpath 'com.github.dcendents:android-maven-gradle-plugin:1.3'
  }
}

plugins {
  id "com.jfrog.bintray" version "1.6"
}

apply plugin: 'java'
apply plugin: 'maven'
apply plugin: 'maven-publish'
apply plugin: 'groovy'

if(project.hasProperty('signing.keyId'))
  apply plugin: 'signing'

group = 'com.github.pareeohnos'
version = '0.1.0'
sourceCompatibility = '1.7'
targetCompatibility = '1.6'

dependencies {
  compile fileTree(dir: 'libs', include: ['*.jar'])
  compile 'com.fasterxml.jackson.core:jackson-databind:2.5.3'
  compile 'com.squareup.okhttp:okhttp-ws:2.7.2'
  testCompile 'org.codehaus.groovy:groovy-all:2.3.10'
  testCompile "org.spockframework:spock-core:1.0-groovy-2.3"

  // optional dependencies for using Spock
  testRuntime "org.hamcrest:hamcrest-core:1.3" // only necessary if Hamcrest matchers are used
  testRuntime "cglib:cglib-nodep:3.1"          // allows mocking of classes (in addition to interfaces)
  testRuntime "org.objenesis:objenesis:2.1"    // allows mocking of classes without default constructor (together with CGLIB)
}

task javadocJar(type: Jar) {
  classifier = 'javadoc'
  from javadoc
}

task sourcesJar(type: Jar) {
  classifier = 'sources'
  from sourceSets.main.allSource
}

repositories {
  mavenCentral()
}

allprojects {
  repositories {
    jcenter()
  }
}


artifacts {
  archives javadocJar, sourcesJar
}

if(project.hasProperty('signing.keyId'))
  signing {
    sign configurations.archives
  }

publishing {
  publications {
    JavaPhoenixChannelsJar(MavenPublication) {
      from components.java
      groupId 'com.github.eoinsha'
      artifactId 'JavaPhoenixChannels'
      version '0.1'
    }
  }
}

bintray {
  user = System.getenv('BINTRAY_USER')
  key = System.getenv('BINTRAY_KEY')
  pkg {
    repo = 'java-phoenix-channels'
    name = 'JavaPhoenixChannels'
    licenses = ['BSD-3']
    vcsUrl = 'https://github.com/eoinsha/JavaPhoenixChannels.git'
  }
  publications = ['JavaPhoenixChannelsJar']
}
